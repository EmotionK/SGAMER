nohup: ignoring input
run.py device: cuda
----------------------------------------------------------------------------------------------------
Amazon_Toys_Games......
----------------------------------------------------------------------------------------------------
labels.shape: torch.Size([3757200])
loading node embedding, all user-item and item-item paths embedding...finished
start training user-item instance self attention module...
user  0 time:  4.291534423828125e-06
user  100 time:  277.16057443618774
user  200 time:  561.5280566215515
user  300 time:  847.154237985611
user  400 time:  847.1595907211304
user  500 time:  847.1647050380707
user  600 time:  847.1686871051788
user  700 time:  847.1727631092072
user  800 time:  847.1768550872803
user  900 time:  847.1809134483337
user  1000 time:  847.1848940849304
user  1100 time:  847.1890661716461
user  1200 time:  847.193035364151
user  1300 time:  847.1971890926361
user  1400 time:  847.2013170719147
user  1500 time:  847.2053575515747
user  1600 time:  847.209450006485
user  1700 time:  847.213883638382
user  1800 time:  847.2178530693054
user  1900 time:  847.22163438797
user  2000 time:  847.2255840301514
user  2100 time:  847.2296259403229
user  2200 time:  847.2336177825928
user  2300 time:  847.2377009391785
user  2400 time:  847.2421686649323
user  2500 time:  847.246146440506
user  2600 time:  847.2502090930939
user  2700 time:  847.2538990974426
user  2800 time:  847.258186340332
user  2900 time:  847.2609481811523
user  3000 time:  847.2646560668945
user  3100 time:  847.2677719593048
user  3200 time:  847.2703082561493
user  3300 time:  847.273547410965
user  3400 time:  847.2770519256592
user  3500 time:  847.2810432910919
user  3600 time:  847.2850546836853
user  3700 time:  847.2895133495331
user  3800 time:  847.293543100357
user  3900 time:  847.2976243495941
user  4000 time:  847.3016664981842
user  4100 time:  847.3058230876923
user  4200 time:  847.3098001480103
user  4300 time:  847.313850402832
user  4400 time:  847.3176739215851
user  4500 time:  847.3212840557098
user  4600 time:  847.324346780777
user  4700 time:  847.3277060985565
user  4800 time:  847.3314990997314
user  4900 time:  847.3346288204193
user  5000 time:  847.3384206295013
user  5100 time:  847.3415870666504
user  5200 time:  847.3456833362579
user  5300 time:  847.3496448993683
user  5400 time:  847.3536834716797
user  5500 time:  847.3579435348511
user  5600 time:  847.3623178005219
user  5700 time:  847.3663454055786
user  5800 time:  847.3702313899994
user  5900 time:  847.3732430934906
user  6000 time:  847.376992225647
user  6100 time:  847.3799815177917
user  6200 time:  847.3833334445953
user  6300 time:  847.3877115249634
user  6400 time:  847.3918237686157
user  6500 time:  847.395870923996
user  6600 time:  847.3999800682068
user  6700 time:  847.4039263725281
user  6800 time:  847.4070501327515
user  6900 time:  847.410756111145
user  7000 time:  847.4148268699646
user  7100 time:  847.4188222885132
user  7200 time:  847.4228928089142
user  7300 time:  847.4269516468048
user  7400 time:  847.4309644699097
user  7500 time:  847.4350001811981
user  7600 time:  847.4387888908386
user  7700 time:  847.4422252178192
user  7800 time:  847.4463286399841
user  7900 time:  847.4502763748169
user  8000 time:  847.4543213844299
user  8100 time:  847.4583306312561
user  8200 time:  847.4628012180328
user  8300 time:  847.4667944908142
user  8400 time:  847.470006942749
user  8500 time:  847.4734845161438
user  8600 time:  847.4771640300751
user  8700 time:  847.4795870780945
user  8800 time:  847.4828443527222
user  8900 time:  847.4855263233185
user  9000 time:  847.4889056682587
user  9100 time:  847.4927270412445
user  9200 time:  847.4967296123505
start training item-item instance self attention module...
user  0 time:  4.0531158447265625e-06
user  100 time:  91.10833144187927
user  200 time:  155.14788222312927
user  300 time:  222.7673807144165
user  400 time:  301.2314524650574
user  500 time:  370.26112604141235
user  600 time:  439.11979603767395
user  700 time:  503.42529129981995
user  800 time:  583.0285377502441
user  900 time:  665.9832234382629
user  1000 time:  740.863597869873
user  1100 time:  816.9709208011627
user  1200 time:  887.4379980564117
user  1300 time:  952.196031332016
user  1400 time:  1013.1881358623505
user  1500 time:  1095.5168492794037
user  1600 time:  1164.2914872169495
user  1700 time:  1240.839518547058
user  1800 time:  1307.7384119033813
user  1900 time:  1371.200359582901
user  2000 time:  1429.7656073570251
user  2100 time:  1502.7164001464844
user  2200 time:  1573.5168690681458
user  2300 time:  1637.2978937625885
user  2400 time:  1707.5415902137756
user  2500 time:  1788.5315952301025
user  2600 time:  1856.0121018886566
user  2700 time:  1932.9704027175903
user  2800 time:  2010.9460270404816
user  2900 time:  2086.7070627212524
user  3000 time:  2160.60040473938
user  3100 time:  2232.439024209976
user  3200 time:  2316.1807203292847
user  3300 time:  2401.221735715866
user  3400 time:  2474.547272205353
user  3500 time:  2547.898320198059
user  3600 time:  2631.2889409065247
user  3700 time:  2702.6783051490784
user  3800 time:  2772.2057914733887
user  3900 time:  2852.7625391483307
user  4000 time:  2935.382184267044
user  4100 time:  3009.0221424102783
user  4200 time:  3095.390454053879
user  4300 time:  3171.368346452713
user  4400 time:  3235.3432111740112
user  4500 time:  3294.6527190208435
user  4600 time:  3384.637959957123
user  4700 time:  3459.984783887863
user  4800 time:  3541.150357723236
user  4900 time:  3617.747992038727
user  5000 time:  3680.564283847809
user  5100 time:  3761.0146951675415
user  5200 time:  3825.857390642166
user  5300 time:  3901.704447746277
user  5400 time:  3968.9303958415985
user  5500 time:  4046.5183086395264
user  5600 time:  4118.92254781723
user  5700 time:  4200.312829256058
user  5800 time:  4262.884969472885
user  5900 time:  4338.499715805054
user  6000 time:  4401.146873950958
user  6100 time:  4468.893393993378
user  6200 time:  4545.568584918976
user  6300 time:  4628.006397008896
user  6400 time:  4707.342499732971
user  6500 time:  4782.371573448181
user  6600 time:  4871.842413902283
user  6700 time:  4945.419727802277
user  6800 time:  5023.768720149994
user  6900 time:  5101.8364174366
user  7000 time:  5160.848954439163
user  7100 time:  5237.377324581146
user  7200 time:  5303.869010210037
user  7300 time:  5376.514446973801
user  7400 time:  5458.506859779358
user  7500 time:  5541.339604377747
user  7600 time:  5607.451599597931
user  7700 time:  5677.355944395065
user  7800 time:  5746.886861562729
user  7900 time:  5831.290922403336
user  8000 time:  5910.595304489136
user  8100 time:  5983.99374127388
user  8200 time:  6064.823595762253
user  8300 time:  6135.757429599762
user  8400 time:  6203.759543180466
user  8500 time:  6270.905464410782
user  8600 time:  6349.751093864441
user  8700 time:  6435.60928106308
user  8800 time:  6513.9030249118805
user  8900 time:  6585.055799007416
user  9000 time:  6661.450825214386
user  9100 time:  6727.755727052689
user  9200 time:  6798.971343278885
start updating user and item embedding...
user_name:9300
user  0 time:  1.71661376953125e-05
user  100 time:  46.36579465866089
user  200 time:  92.6368305683136
user  300 time:  132.64709639549255
user  400 time:  181.45651507377625
user  500 time:  229.24816632270813
user  600 time:  275.98386812210083
user  700 time:  322.95489263534546
user  800 time:  370.069650888443
user  900 time:  417.26520109176636
user  1000 time:  463.70780658721924
user  1100 time:  512.7920522689819
user  1200 time:  557.9163575172424
user  1300 time:  598.6098256111145
user  1400 time:  639.6928684711456
user  1500 time:  682.4967730045319
user  1600 time:  723.8434090614319
user  1700 time:  764.7555906772614
user  1800 time:  810.5041882991791
user  1900 time:  857.371529340744
user  2000 time:  904.2150166034698
user  2100 time:  951.1785411834717
user  2200 time:  998.5466296672821
user  2300 time:  1042.033537387848
user  2400 time:  1087.8957579135895
user  2500 time:  1135.098638534546
user  2600 time:  1181.5779967308044
user  2700 time:  1223.0387632846832
user  2800 time:  1272.557636499405
user  2900 time:  1319.812748670578
user  3000 time:  1365.9431385993958
user  3100 time:  1407.195473909378
user  3200 time:  1448.8398735523224
user  3300 time:  1489.226862668991
user  3400 time:  1533.368079662323
user  3500 time:  1573.6445472240448
user  3600 time:  1615.301596403122
user  3700 time:  1656.3550486564636
user  3800 time:  1704.5654683113098
user  3900 time:  1750.6618032455444
user  4000 time:  1797.3879272937775
user  4100 time:  1850.076049566269
user  4200 time:  1897.419920682907
user  4300 time:  1943.4570336341858
user  4400 time:  1990.5728759765625
user  4500 time:  2037.3234660625458
user  4600 time:  2083.904470682144
user  4700 time:  2128.4291656017303
user  4800 time:  2171.4798707962036
user  4900 time:  2212.5183296203613
user  5000 time:  2252.599442958832
user  5100 time:  2294.666534423828
user  5200 time:  2340.0413315296173
user  5300 time:  2385.2152984142303
user  5400 time:  2430.3561794757843
user  5500 time:  2475.4588329792023
user  5600 time:  2523.043607711792
user  5700 time:  2568.729090452194
user  5800 time:  2616.189059972763
user  5900 time:  2661.4227409362793
user  6000 time:  2705.3925981521606
user  6100 time:  2750.662794113159
user  6200 time:  2796.009495973587
user  6300 time:  2841.4017326831818
user  6400 time:  2886.7985587120056
user  6500 time:  2932.097903251648
user  6600 time:  2977.607275724411
user  6700 time:  3022.8270914554596
user  6800 time:  3068.090300798416
user  6900 time:  3113.5658569335938
user  7000 time:  3160.449416399002
user  7100 time:  3200.0712416172028
user  7200 time:  3240.9036979675293
user  7300 time:  3281.9772322177887
user  7400 time:  3328.824450492859
user  7500 time:  3374.402918815613
user  7600 time:  3418.3245329856873
user  7700 time:  3466.1111340522766
user  7800 time:  3511.2051634788513
user  7900 time:  3556.56023812294
user  8000 time:  3602.0324170589447
user  8100 time:  3646.975570201874
user  8200 time:  3692.276510953903
user  8300 time:  3737.5029492378235
user  8400 time:  3783.139726638794
user  8500 time:  3829.69140958786
user  8600 time:  3874.9767525196075
user  8700 time:  3918.540024280548
user  8800 time:  3966.10759973526
user  8900 time:  4015.1816668510437
user  9000 time:  4063.33531999588
user  9100 time:  4108.48592042923
user  9200 time:  4152.693739414215
start training recommendation module...
recommendation_model2.py:59: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  fe = F.log_softmax(output)
epoch: 0, training loss: 591.9598535341211, train time: 16295.524727582932
epoch: 1, training loss: 475.13131871457153, train time: 17450.313538312912
epoch: 2, training loss: 462.76699220108276, train time: 12717.358371973038
epoch: 3, training loss: 455.9558468239702, train time: 12669.36352801323
epoch: 4, training loss: 452.9931953300111, train time: 12698.714153051376
epoch: 5, training loss: 448.7894500893017, train time: 12675.95573091507
epoch: 6, training loss: 445.7898648280825, train time: 12490.381813526154
epoch: 7, training loss: 444.01128788728965, train time: 13112.10676240921
epoch: 8, training loss: 444.7955676779093, train time: 14096.908926963806
epoch: 9, training loss: 440.91825021059776, train time: 12478.672591924667
epoch: 10, training loss: 439.9015586287278, train time: 12499.385332345963
epoch: 11, training loss: 441.09088217045064, train time: 12483.905853748322
epoch: 12, training loss: 439.88490458032175, train time: 12483.819337368011
epoch: 13, training loss: 440.71606885502115, train time: 12667.756617069244
epoch: 14, training loss: 439.91645047023485, train time: 12706.141111373901
epoch: 15, training loss: 441.099739801808, train time: 12693.23350930214
epoch: 16, training loss: 440.71847267172416, train time: 12655.765916585922
epoch: 17, training loss: 439.06130652691354, train time: 12717.663554430008
epoch: 18, training loss: 441.59923986077774, train time: 12744.772410154343
epoch: 19, training loss: 441.7183400992508, train time: 12726.771067619324
epoch: 20, training loss: 443.7011323713232, train time: 12689.362303495407
epoch: 21, training loss: 441.661101715581, train time: 12714.190370321274
epoch: 22, training loss: 441.21447926710243, train time: 12699.107659339905
epoch: 23, training loss: 441.6005727331212, train time: 12720.168483018875
epoch: 24, training loss: 441.56800220155856, train time: 12698.151979207993
epoch: 25, training loss: 443.33547744492535, train time: 12708.74319934845
epoch: 26, training loss: 442.89449571678415, train time: 12682.07033276558
epoch: 27, training loss: 444.4915462345816, train time: 12707.422492980957
epoch: 28, training loss: 445.02472812859924, train time: 12686.824294090271
epoch: 29, training loss: 444.26368715279386, train time: 12699.689692735672
epo:29 | HR@5:0.8950 | HR@10:0.9169 | HR@20:0.9411 | NDCG@5:0.3811 | NDCG@10:0.4269 | NDCG@20:0.4823 | recall@5:0.6181 | recall@10:0.7474 | recall@20:0.7754 | precision@5:0.7417 | precision@10:0.4484 | precision@20:0.2326 | best_HR@5:0.8950 | best_HR@10:0.9169 | best_HR@20:0.9411 | best_NDCG@5:0.3811 | best_NDCG@10:0.4269 | best_NDCG@20:0.4823 | best_recall@5:0.6181 | best_recall@10:0.7474 | best_recall@20:0.7754 | best_precision@5:0.7417 | best_precision@10:0.4484 | best_precision@20:0.2326 | 
epoch: 30, training loss: 445.75528950433363, train time: 12690.666533231735
epoch: 31, training loss: 446.6205638885731, train time: 12670.187683105469
epoch: 32, training loss: 446.1935035948991, train time: 12699.723437786102
epoch: 33, training loss: 443.85473615446244, train time: 12680.783701181412
epoch: 34, training loss: 444.26459459774196, train time: 12618.997836351395
epoch: 35, training loss: 444.7528362136218, train time: 12677.068486213684
epoch: 36, training loss: 443.96948548678483, train time: 12692.081278562546
epoch: 37, training loss: 441.9600398155453, train time: 12703.0738260746
epoch: 38, training loss: 444.9567661052424, train time: 12684.702347040176
epoch: 39, training loss: 444.9543686824909, train time: 12745.871671676636
epoch: 40, training loss: 444.7203724482679, train time: 12600.349669456482
epoch: 41, training loss: 446.428130807064, train time: 12484.964033126831
epoch: 42, training loss: 445.31008847872727, train time: 12519.488558530807
epoch: 43, training loss: 446.21872256469214, train time: 12501.2201962471
epoch: 44, training loss: 446.69487629135256, train time: 12482.807995319366
epoch: 45, training loss: 448.0067313858017, train time: 12566.46864080429
epoch: 46, training loss: 447.3238588293316, train time: 12697.76968741417
epoch: 47, training loss: 448.8743153429823, train time: 12686.45696258545
epoch: 48, training loss: 449.0192185838823, train time: 12664.756759881973
epoch: 49, training loss: 449.4737793941749, train time: 12679.7908244133
epoch: 50, training loss: 449.03384648886276, train time: 12698.454200267792
epoch: 51, training loss: 448.39425497312914, train time: 12679.702778100967
epoch: 52, training loss: 450.90752664691536, train time: 12719.784379720688
epoch: 53, training loss: 450.83406718831975, train time: 12662.88946557045
epoch: 54, training loss: 452.3641711650416, train time: 12702.395185470581
epoch: 55, training loss: 450.958857344056, train time: 12683.554320573807
epoch: 56, training loss: 451.84621330641676, train time: 12713.18065738678
epoch: 57, training loss: 451.82467636291403, train time: 12694.98237323761
epoch: 58, training loss: 450.2919716341421, train time: 12663.59468960762
epoch: 59, training loss: 453.64843211197876, train time: 12719.580412864685
epo:59 | HR@5:0.8602 | HR@10:0.8863 | HR@20:0.9178 | NDCG@5:0.3619 | NDCG@10:0.4063 | NDCG@20:0.4623 | recall@5:0.6061 | recall@10:0.7197 | recall@20:0.7538 | precision@5:0.7274 | precision@10:0.4318 | precision@20:0.2261 | best_HR@5:0.8950 | best_HR@10:0.9169 | best_HR@20:0.9411 | best_NDCG@5:0.3811 | best_NDCG@10:0.4269 | best_NDCG@20:0.4823 | best_recall@5:0.6181 | best_recall@10:0.7474 | best_recall@20:0.7754 | best_precision@5:0.7417 | best_precision@10:0.4484 | best_precision@20:0.2326 | 
epoch: 60, training loss: 452.4399082035525, train time: 12704.10674738884
epoch: 61, training loss: 453.3287456558319, train time: 12698.867807865143
epoch: 62, training loss: 453.9112785618345, train time: 12732.489534139633
epoch: 63, training loss: 455.45883817700087, train time: 12697.145743131638
epoch: 64, training loss: 456.4979386481864, train time: 12668.843918323517
epoch: 65, training loss: 456.06119952420704, train time: 12752.969908237457
epoch: 66, training loss: 454.5795263790933, train time: 12513.880668401718
epoch: 67, training loss: 455.9629135989235, train time: 12474.933963298798
epoch: 68, training loss: 458.6988062450255, train time: 12501.350376605988
epoch: 69, training loss: 459.36736543354345, train time: 12504.950241088867
epoch: 70, training loss: 456.9004688631685, train time: 12522.2911734581
epoch: 71, training loss: 457.80171134273405, train time: 12532.843164205551
epoch: 72, training loss: 458.1467316422786, train time: 12478.6092004776
epoch: 73, training loss: 461.59263252076926, train time: 12505.65176486969
epoch: 74, training loss: 459.07791500823805, train time: 12508.54468011856
epoch: 75, training loss: 458.98623483997653, train time: 12497.27763080597
epoch: 76, training loss: 459.21988934042747, train time: 12533.377731323242
epoch: 77, training loss: 457.598741493799, train time: 12492.435532569885
epoch: 78, training loss: 462.05205876068794, train time: 12465.629882097244
