nohup: ignoring input
run.py device: cuda
----------------------------------------------------------------------------------------------------
Amazon_Toys_Games......
----------------------------------------------------------------------------------------------------
labels.shape: torch.Size([3757200])
loading node embedding, all user-item and item-item paths embedding...finished
start training user-item instance self attention module...
user  0 time:  4.291534423828125e-06
user  100 time:  244.15616512298584
user  200 time:  488.1264691352844
user  300 time:  733.2025032043457
user  400 time:  733.2058720588684
user  500 time:  733.2115263938904
user  600 time:  733.2155771255493
user  700 time:  733.2195792198181
user  800 time:  733.2235946655273
user  900 time:  733.2274477481842
user  1000 time:  733.2297880649567
user  1100 time:  733.2323071956635
user  1200 time:  733.234522819519
user  1300 time:  733.2380185127258
user  1400 time:  733.2405393123627
user  1500 time:  733.242880821228
user  1600 time:  733.2451391220093
user  1700 time:  733.2476518154144
user  1800 time:  733.2499318122864
user  1900 time:  733.2522537708282
user  2000 time:  733.2544546127319
user  2100 time:  733.2566277980804
user  2200 time:  733.2588202953339
user  2300 time:  733.2609813213348
user  2400 time:  733.2649941444397
user  2500 time:  733.2675879001617
user  2600 time:  733.2698156833649
user  2700 time:  733.2720046043396
user  2800 time:  733.2742097377777
user  2900 time:  733.2765374183655
user  3000 time:  733.2790653705597
user  3100 time:  733.2812316417694
user  3200 time:  733.2834112644196
user  3300 time:  733.2856066226959
user  3400 time:  733.2878060340881
user  3500 time:  733.291654586792
user  3600 time:  733.2941052913666
user  3700 time:  733.2967128753662
user  3800 time:  733.2990491390228
user  3900 time:  733.3016774654388
user  4000 time:  733.3050394058228
user  4100 time:  733.3090176582336
user  4200 time:  733.313069820404
user  4300 time:  733.3174662590027
user  4400 time:  733.3214344978333
user  4500 time:  733.3252522945404
user  4600 time:  733.3278965950012
user  4700 time:  733.3305571079254
user  4800 time:  733.3345460891724
user  4900 time:  733.338525056839
user  5000 time:  733.3429138660431
user  5100 time:  733.3469514846802
user  5200 time:  733.3508648872375
user  5300 time:  733.3538446426392
user  5400 time:  733.3569116592407
user  5500 time:  733.3609881401062
user  5600 time:  733.3653202056885
user  5700 time:  733.3693280220032
user  5800 time:  733.373330116272
user  5900 time:  733.3772242069244
user  6000 time:  733.3802623748779
user  6100 time:  733.3832700252533
user  6200 time:  733.3868441581726
user  6300 time:  733.3911709785461
user  6400 time:  733.3952434062958
user  6500 time:  733.3993096351624
user  6600 time:  733.4032981395721
user  6700 time:  733.4068961143494
user  6800 time:  733.4093084335327
user  6900 time:  733.4128742218018
user  7000 time:  733.4168746471405
user  7100 time:  733.4208965301514
user  7200 time:  733.4249310493469
user  7300 time:  733.4289352893829
user  7400 time:  733.4328031539917
user  7500 time:  733.4357252120972
user  7600 time:  733.439980506897
user  7700 time:  733.4423592090607
user  7800 time:  733.4445381164551
user  7900 time:  733.4467532634735
user  8000 time:  733.4489786624908
user  8100 time:  733.451178073883
user  8200 time:  733.4537029266357
user  8300 time:  733.4561033248901
user  8400 time:  733.4588646888733
user  8500 time:  733.4610257148743
user  8600 time:  733.4632184505463
user  8700 time:  733.4663879871368
user  8800 time:  733.470376253128
user  8900 time:  733.4746527671814
user  9000 time:  733.4787395000458
user  9100 time:  733.4827826023102
user  9200 time:  733.4867985248566
start training item-item instance self attention module...
user  0 time:  4.76837158203125e-06
user  100 time:  76.43835806846619
user  200 time:  129.99393391609192
user  300 time:  186.67207050323486
user  400 time:  252.8795120716095
user  500 time:  310.67719984054565
user  600 time:  367.9549241065979
user  700 time:  421.95161652565
user  800 time:  488.0503885746002
user  900 time:  557.5342016220093
user  1000 time:  620.1194796562195
user  1100 time:  683.7796552181244
user  1200 time:  742.8799815177917
user  1300 time:  796.49613904953
user  1400 time:  847.555135011673
user  1500 time:  916.7726230621338
user  1600 time:  974.3179721832275
user  1700 time:  1038.381012916565
user  1800 time:  1094.2654159069061
user  1900 time:  1147.384433746338
user  2000 time:  1196.1457250118256
user  2100 time:  1257.1399328708649
user  2200 time:  1316.3034455776215
user  2300 time:  1369.6225609779358
user  2400 time:  1428.263661623001
user  2500 time:  1500.6627485752106
user  2600 time:  1560.875604391098
user  2700 time:  1629.062971830368
user  2800 time:  1702.2308466434479
user  2900 time:  1777.22061252594
user  3000 time:  1853.7007837295532
user  3100 time:  1927.2388577461243
user  3200 time:  2011.2566905021667
user  3300 time:  2094.8546884059906
user  3400 time:  2162.7003786563873
user  3500 time:  2234.700044155121
user  3600 time:  2319.2223677635193
user  3700 time:  2392.5148317813873
user  3800 time:  2461.7304124832153
user  3900 time:  2534.301731109619
user  4000 time:  2617.0224709510803
user  4100 time:  2688.7794075012207
user  4200 time:  2773.65389752388
user  4300 time:  2847.839341402054
user  4400 time:  2907.6043186187744
user  4500 time:  2961.516998529434
user  4600 time:  3043.5121953487396
user  4700 time:  3115.9242486953735
user  4800 time:  3192.922788143158
user  4900 time:  3269.526905298233
user  5000 time:  3330.4758608341217
user  5100 time:  3406.206737756729
user  5200 time:  3466.192215681076
user  5300 time:  3537.214153766632
user  5400 time:  3602.423432826996
user  5500 time:  3675.07217669487
user  5600 time:  3742.997208595276
user  5700 time:  3817.365443944931
user  5800 time:  3875.1271588802338
user  5900 time:  3949.1815152168274
user  6000 time:  4007.4144365787506
user  6100 time:  4069.939414024353
user  6200 time:  4146.976166725159
user  6300 time:  4223.662145137787
user  6400 time:  4299.294399261475
user  6500 time:  4367.757878541946
user  6600 time:  4447.974089622498
user  6700 time:  4515.843886137009
user  6800 time:  4598.794988870621
user  6900 time:  4676.113968849182
user  7000 time:  4732.171922683716
user  7100 time:  4806.038934469223
user  7200 time:  4867.911775588989
user  7300 time:  4938.98499751091
user  7400 time:  5016.168503522873
user  7500 time:  5090.624093294144
user  7600 time:  5150.925340414047
user  7700 time:  5217.327780723572
user  7800 time:  5286.598544120789
user  7900 time:  5377.280152797699
user  8000 time:  5455.005413770676
user  8100 time:  5518.029742479324
user  8200 time:  5586.844531059265
user  8300 time:  5647.288245201111
user  8400 time:  5704.174950838089
user  8500 time:  5760.76505947113
user  8600 time:  5827.137728214264
user  8700 time:  5899.010920286179
user  8800 time:  5964.829017162323
user  8900 time:  6024.154172182083
user  9000 time:  6088.235750675201
user  9100 time:  6143.77863407135
user  9200 time:  6203.061799526215
start updating user and item embedding...
user_name:9300
user  0 time:  1.0013580322265625e-05
user  100 time:  64.3177261352539
user  200 time:  128.6414294242859
user  300 time:  192.89162421226501
user  400 time:  257.194007396698
user  500 time:  321.3353600502014
user  600 time:  384.9249994754791
user  700 time:  448.7303202152252
user  800 time:  513.0738990306854
user  900 time:  576.9538264274597
user  1000 time:  641.0851743221283
user  1100 time:  705.3006801605225
user  1200 time:  768.9894824028015
user  1300 time:  833.1790690422058
user  1400 time:  897.2657787799835
user  1500 time:  961.695606470108
user  1600 time:  1026.2705512046814
user  1700 time:  1090.505119085312
user  1800 time:  1154.5095744132996
user  1900 time:  1218.0475533008575
user  2000 time:  1281.4602720737457
user  2100 time:  1345.0606083869934
user  2200 time:  1409.1260862350464
user  2300 time:  1472.6173839569092
user  2400 time:  1536.3394119739532
user  2500 time:  1599.9412479400635
user  2600 time:  1663.5855057239532
user  2700 time:  1728.8844089508057
user  2800 time:  1792.8195672035217
user  2900 time:  1856.9763662815094
user  3000 time:  1921.4530091285706
user  3100 time:  1986.592292547226
user  3200 time:  2059.6875801086426
user  3300 time:  2135.547440290451
user  3400 time:  2209.7663061618805
user  3500 time:  2284.6216390132904
user  3600 time:  2359.52334523201
user  3700 time:  2434.294894695282
user  3800 time:  2511.4349315166473
user  3900 time:  2586.597142934799
user  4000 time:  2662.0726437568665
user  4100 time:  2740.6389815807343
user  4200 time:  2820.6771941184998
user  4300 time:  2899.4007754325867
user  4400 time:  2976.3558592796326
user  4500 time:  3055.9807505607605
user  4600 time:  3138.204961538315
user  4700 time:  3218.511205434799
user  4800 time:  3299.18972325325
user  4900 time:  3381.900319337845
user  5000 time:  3462.736634016037
user  5100 time:  3544.4061846733093
user  5200 time:  3626.3704335689545
user  5300 time:  3708.7348358631134
user  5400 time:  3790.4172728061676
user  5500 time:  3872.550458431244
user  5600 time:  3954.7015855312347
user  5700 time:  4038.3623678684235
user  5800 time:  4121.371839523315
user  5900 time:  4203.555354833603
user  6000 time:  4286.463799715042
user  6100 time:  4369.731286764145
user  6200 time:  4452.9311265945435
user  6300 time:  4535.253500699997
user  6400 time:  4615.234347581863
user  6500 time:  4697.916902542114
user  6600 time:  4780.181279182434
user  6700 time:  4862.612860441208
user  6800 time:  4944.683702468872
user  6900 time:  5026.877015352249
user  7000 time:  5108.618662118912
user  7100 time:  5191.555518865585
user  7200 time:  5274.836559295654
user  7300 time:  5357.161251544952
user  7400 time:  5437.974846601486
user  7500 time:  5521.764831781387
user  7600 time:  5605.11443400383
user  7700 time:  5687.138727903366
user  7800 time:  5769.362143278122
user  7900 time:  5852.953577756882
user  8000 time:  5936.134815454483
user  8100 time:  6018.97544670105
user  8200 time:  6102.129179954529
user  8300 time:  6185.365212440491
user  8400 time:  6267.346065998077
user  8500 time:  6349.485455751419
user  8600 time:  6432.257936477661
user  8700 time:  6514.023029327393
user  8800 time:  6596.332856893539
user  8900 time:  6678.10249209404
user  9000 time:  6758.996897935867
user  9100 time:  6842.101867675781
user  9200 time:  6925.282961368561
start training recommendation module...
recommendation_model2.py:59: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  fe = F.log_softmax(output)
epoch: 0, training loss: 589.6096348598658, train time: 15554.696294784546
epoch: 1, training loss: 476.3146990489622, train time: 12720.119895935059
epoch: 2, training loss: 463.0992838931561, train time: 12735.651108980179
epoch: 3, training loss: 455.76521600884735, train time: 12735.537935972214
epoch: 4, training loss: 451.69117902337166, train time: 12649.719014644623
epoch: 5, training loss: 447.22410450552707, train time: 12496.698949337006
epoch: 6, training loss: 442.52064161717135, train time: 14568.367176294327
epoch: 7, training loss: 443.96482654710417, train time: 12682.775714159012
epoch: 8, training loss: 440.1080320599722, train time: 12497.119510650635
epoch: 9, training loss: 439.37800483513274, train time: 12541.600851535797
epoch: 10, training loss: 438.5438089733361, train time: 12506.066347837448
epoch: 11, training loss: 438.00133319933957, train time: 12621.438554286957
epoch: 12, training loss: 437.83425444862223, train time: 12739.440310955048
epoch: 13, training loss: 437.00529277240275, train time: 12708.199261426926
epoch: 14, training loss: 437.70988590820343, train time: 12711.744085788727
epoch: 15, training loss: 438.6184633090161, train time: 12761.382350444794
epoch: 16, training loss: 439.0529188857763, train time: 12758.61658167839
epoch: 17, training loss: 437.0471721699578, train time: 12783.434480428696
epoch: 18, training loss: 440.15590559964767, train time: 12722.542877912521
epoch: 19, training loss: 438.38342914453824, train time: 12746.068350553513
epoch: 20, training loss: 438.4942889596423, train time: 12731.527197599411
epoch: 21, training loss: 439.62196987090283, train time: 12722.084819555283
epoch: 22, training loss: 440.1894960535428, train time: 12724.584713220596
epoch: 23, training loss: 438.4242666733335, train time: 12718.050329685211
epoch: 24, training loss: 439.43224022584036, train time: 12745.162467241287
epoch: 25, training loss: 438.9641658033943, train time: 12710.701457738876
epoch: 26, training loss: 438.9772605574108, train time: 12739.45316696167
epoch: 27, training loss: 436.86987882196263, train time: 12701.750214576721
epoch: 28, training loss: 438.16494850089657, train time: 12529.728243112564
epoch: 29, training loss: 437.33668761084846, train time: 12718.385805606842
epo:29 | HR@5:0.8829 | HR@10:0.9063 | HR@20:0.9348 | NDCG@5:0.4077 | NDCG@10:0.4524 | NDCG@20:0.5059 | recall@5:0.6177 | recall@10:0.7379 | recall@20:0.7684 | precision@5:0.7413 | precision@10:0.4428 | precision@20:0.2305 | best_HR@5:0.8829 | best_HR@10:0.9063 | best_HR@20:0.9348 | best_NDCG@5:0.4077 | best_NDCG@10:0.4524 | best_NDCG@20:0.5059 | best_recall@5:0.6177 | best_recall@10:0.7379 | best_recall@20:0.7684 | best_precision@5:0.7413 | best_precision@10:0.4428 | best_precision@20:0.2305 | 
epoch: 30, training loss: 437.16821371924016, train time: 12788.644029378891
epoch: 31, training loss: 437.60634583147475, train time: 12726.975738286972
epoch: 32, training loss: 437.97672531561693, train time: 12666.010999917984
epoch: 33, training loss: 439.3829468160693, train time: 12707.690656661987
epoch: 34, training loss: 439.24766015366185, train time: 12728.18443775177
epoch: 35, training loss: 439.71444584446726, train time: 12740.360726356506
epoch: 36, training loss: 439.43008594206185, train time: 12735.482014417648
epoch: 37, training loss: 440.59445900982246, train time: 12756.094618797302
epoch: 38, training loss: 438.60391968878685, train time: 12774.709034919739
epoch: 39, training loss: 440.90979896849603, train time: 12572.410853624344
epoch: 40, training loss: 441.5496282961685, train time: 12591.722278356552
epoch: 41, training loss: 441.1250818966073, train time: 12536.783720970154
epoch: 42, training loss: 441.9574109680834, train time: 12565.00964808464
epoch: 43, training loss: 440.85272887311294, train time: 12556.656412124634
epoch: 44, training loss: 441.7348359738535, train time: 12702.744740486145
epoch: 45, training loss: 440.5065736831748, train time: 12723.549459934235
epoch: 46, training loss: 442.02221731151803, train time: 12697.960073947906
epoch: 47, training loss: 442.90974782733247, train time: 12714.655065059662
epoch: 48, training loss: 442.4708917772223, train time: 12754.377541542053
epoch: 49, training loss: 443.24557533007464, train time: 12738.961400270462
epoch: 50, training loss: 445.4459143333952, train time: 12735.702363729477
epoch: 51, training loss: 443.5126804129686, train time: 12760.414431810379
epoch: 52, training loss: 446.14458286433364, train time: 12735.995982646942
epoch: 53, training loss: 445.1575874047121, train time: 12738.276015043259
epoch: 54, training loss: 445.00585125834914, train time: 12743.246552467346
epoch: 55, training loss: 444.9406780032441, train time: 12705.691339969635
epoch: 56, training loss: 443.79589157016017, train time: 12729.647128582
epoch: 57, training loss: 445.39390626651584, train time: 12747.844785928726
epoch: 58, training loss: 446.05081888998393, train time: 12639.957991838455
epoch: 59, training loss: 448.84259632849717, train time: 12738.488929748535
epo:59 | HR@5:0.8803 | HR@10:0.9023 | HR@20:0.9280 | NDCG@5:0.3752 | NDCG@10:0.4221 | NDCG@20:0.4789 | recall@5:0.6117 | recall@10:0.7354 | recall@20:0.7639 | precision@5:0.7341 | precision@10:0.4413 | precision@20:0.2292 | best_HR@5:0.8829 | best_HR@10:0.9063 | best_HR@20:0.9348 | best_NDCG@5:0.4077 | best_NDCG@10:0.4524 | best_NDCG@20:0.5059 | best_recall@5:0.6177 | best_recall@10:0.7379 | best_recall@20:0.7684 | best_precision@5:0.7413 | best_precision@10:0.4428 | best_precision@20:0.2305 | 
epoch: 60, training loss: 447.8050059621455, train time: 12719.039239168167
epoch: 61, training loss: 446.7212715303758, train time: 12737.484029769897
epoch: 62, training loss: 445.901069987347, train time: 12719.206086874008
epoch: 63, training loss: 445.85109175529215, train time: 12735.690590381622
epoch: 64, training loss: 446.93406273730216, train time: 12717.55476975441
epoch: 65, training loss: 449.7538410113775, train time: 12512.621898412704
epoch: 66, training loss: 450.0230250360037, train time: 12518.186748743057
epoch: 67, training loss: 454.5376235288277, train time: 12554.020852327347
epoch: 68, training loss: 452.2753263581253, train time: 12536.374199151993
epoch: 69, training loss: 450.6072852630459, train time: 12582.200341701508
epoch: 70, training loss: 455.21836831836845, train time: 12530.726014375687
epoch: 71, training loss: 453.7965238042234, train time: 12551.736417770386
epoch: 72, training loss: 453.7439442462637, train time: 12546.667771100998
epoch: 73, training loss: 455.4014070474077, train time: 12513.31176519394
epoch: 74, training loss: 455.85690502484795, train time: 12542.168830871582
epoch: 75, training loss: 455.01824031904107, train time: 12554.455384969711
epoch: 76, training loss: 457.48468758995296, train time: 12486.853228092194
epoch: 77, training loss: 456.59287116100313, train time: 12528.9872777462
